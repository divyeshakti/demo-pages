var interactjs=function(){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function n(t,e){return t(e={exports:{}},e.exports),e.exports}var r=n((function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)})),i=n((function(t){var e=t.exports={version:"2.6.12"};"number"==typeof __e&&(__e=e)})),o=(i.version,function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}),a=function(t,e,n){if(o(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}},s=function(t){return"object"==typeof t?null!==t:"function"==typeof t},c=function(t){if(!s(t))throw TypeError(t+" is not an object!");return t},u=function(t){try{return!!t()}catch(t){return!0}},l=!u((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),f=r.document,h=s(f)&&s(f.createElement),d=function(t){return h?f.createElement(t):{}},p=!l&&!u((function(){return 7!=Object.defineProperty(d("div"),"a",{get:function(){return 7}}).a})),v=function(t,e){if(!s(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!s(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!s(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!s(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},g=Object.defineProperty,y={f:l?Object.defineProperty:function(t,e,n){if(c(t),e=v(e,!0),c(n),p)try{return g(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},m=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},_=l?function(t,e,n){return y.f(t,e,m(1,n))}:function(t,e,n){return t[e]=n,t},S={}.hasOwnProperty,w=function(t,e){return S.call(t,e)},b=function(t,e,n){var o,s,c,u=t&b.F,l=t&b.G,f=t&b.S,h=t&b.P,d=t&b.B,p=t&b.W,v=l?i:i[e]||(i[e]={}),g=v.prototype,y=l?r:f?r[e]:(r[e]||{}).prototype;for(o in l&&(n=e),n)(s=!u&&y&&void 0!==y[o])&&w(v,o)||(c=s?y[o]:n[o],v[o]=l&&"function"!=typeof y[o]?n[o]:d&&s?a(c,r):p&&y[o]==c?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(c):h&&"function"==typeof c?a(Function.call,c):c,h&&((v.virtual||(v.virtual={}))[o]=c,t&b.R&&g&&!g[o]&&_(g,o,c)))};b.F=1,b.G=2,b.S=4,b.P=8,b.B=16,b.W=32,b.U=64,b.R=128;var I=b;I(I.S+I.F*!l,"Object",{defineProperty:y.f});var x=i.Object,k=function(t,e,n){return x.defineProperty(t,e,n)},O=0,C=Math.random(),E=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++O+C).toString(36))},j=n((function(t){var e=E("meta"),n=y.f,r=0,i=Object.isExtensible||function(){return!0},o=!u((function(){return i(Object.preventExtensions({}))})),a=function(t){n(t,e,{value:{i:"O"+ ++r,w:{}}})},c=t.exports={KEY:e,NEED:!1,fastKey:function(t,n){if(!s(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!w(t,e)){if(!i(t))return"F";if(!n)return"E";a(t)}return t[e].i},getWeak:function(t,n){if(!w(t,e)){if(!i(t))return!0;if(!n)return!1;a(t)}return t[e].w},onFreeze:function(t){return o&&c.NEED&&i(t)&&!w(t,e)&&a(t),t}}})),T=(j.KEY,j.NEED,j.fastKey,j.getWeak,j.onFreeze,function(t,e){var n=(i.Object||{})[t]||Object[t],r={};r[t]=e(n),I(I.S+I.F*u((function(){n(1)})),"Object",r)}),A=j.onFreeze;T("seal",(function(t){return function(e){return t&&s(e)?t(A(e)):e}}));var D,P=i.Object.seal,L=n((function(e){var n,r;n=t,r=function(){var t=function(){},e="undefined"!=typeof window&&void 0!==window.navigator&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"];function r(t,e){var n=t[e];if("function"==typeof n.bind)return n.bind(t);try{return Function.prototype.bind.call(n,t)}catch(e){return function(){return Function.prototype.apply.apply(n,[t,arguments])}}}function i(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function o(n){return"debug"===n&&(n="log"),"undefined"!=typeof console&&("trace"===n&&e?i:void 0!==console[n]?r(console,n):void 0!==console.log?r(console,"log"):t)}function a(e,r){for(var i=0;i<n.length;i++){var o=n[i];this[o]=i<e?t:this.methodFactory(o,e,r)}this.log=this.debug}function s(t,e,n){return function(){"undefined"!=typeof console&&(a.call(this,e,n),this[t].apply(this,arguments))}}function c(t,e,n){return o(t)||s.apply(this,arguments)}function u(t,e,r){var i,o=this,s="loglevel";function u(){var t;if("undefined"!=typeof window&&s){try{t=window.localStorage[s]}catch(t){}if(void 0===t)try{var e=window.document.cookie,n=e.indexOf(encodeURIComponent(s)+"=");-1!==n&&(t=/^([^;]+)/.exec(e.slice(n))[1])}catch(t){}return void 0===o.levels[t]&&(t=void 0),t}}"string"==typeof t?s+=":"+t:"symbol"==typeof t&&(s=void 0),o.name=t,o.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},o.methodFactory=r||c,o.getLevel=function(){return i},o.setLevel=function(e,r){if("string"==typeof e&&void 0!==o.levels[e.toUpperCase()]&&(e=o.levels[e.toUpperCase()]),!("number"==typeof e&&e>=0&&e<=o.levels.SILENT))throw"log.setLevel() called with invalid level: "+e;if(i=e,!1!==r&&function(t){var e=(n[t]||"silent").toUpperCase();if("undefined"!=typeof window&&s){try{return void(window.localStorage[s]=e)}catch(t){}try{window.document.cookie=encodeURIComponent(s)+"="+e+";"}catch(t){}}}(e),a.call(o,e,t),"undefined"==typeof console&&e<o.levels.SILENT)return"No console available for logging"},o.setDefaultLevel=function(t){u()||o.setLevel(t,!1)},o.enableAll=function(t){o.setLevel(o.levels.TRACE,t)},o.disableAll=function(t){o.setLevel(o.levels.SILENT,t)};var l=u();null==l&&(l=null==e?"WARN":e),o.setLevel(l,!1)}var l=new u,f={};l.getLogger=function(t){if("symbol"!=typeof t&&"string"!=typeof t||""===t)throw new TypeError("You must supply a name when creating a logger.");var e=f[t];return e||(e=f[t]=new u(t,l.getLevel(),l.methodFactory)),e};var h="undefined"!=typeof window?window.log:void 0;return l.noConflict=function(){return"undefined"!=typeof window&&window.log===l&&(window.log=h),l},l.getLoggers=function(){return f},l.default=l,l},e.exports?e.exports=r():n.log=r()})),F=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},U=function(t){return Object(F(t))},z={}.toString,N=function(t){return z.call(t).slice(8,-1)},R=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==N(t)?t.split(""):Object(t)},M=function(t){return R(F(t))},B=Math.ceil,G=Math.floor,Z=function(t){return isNaN(t=+t)?0:(t>0?G:B)(t)},H=Math.min,q=function(t){return t>0?H(Z(t),9007199254740991):0},K=Math.max,V=Math.min,W=n((function(t){var e=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(t.exports=function(t,n){return e[t]||(e[t]=void 0!==n?n:{})})("versions",[]).push({version:i.version,mode:"pure",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})})),J=W("keys"),$=function(t){return J[t]||(J[t]=E(t))},Q=(D=!1,function(t,e,n){var r,i=M(t),o=q(i.length),a=function(t,e){return(t=Z(t))<0?K(t+e,0):V(t,e)}(n,o);if(D&&e!=e){for(;o>a;)if((r=i[a++])!=r)return!0}else for(;o>a;a++)if((D||a in i)&&i[a]===e)return D||a||0;return!D&&-1}),Y=$("IE_PROTO"),X=function(t,e){var n,r=M(t),i=0,o=[];for(n in r)n!=Y&&w(r,n)&&o.push(n);for(;e.length>i;)w(r,n=e[i++])&&(~Q(o,n)||o.push(n));return o},tt="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),et=Object.keys||function(t){return X(t,tt)};T("keys",(function(){return function(t){return et(U(t))}}));var nt=i.Object.keys,rt=_,it=n((function(t){var e=W("wks"),n=r.Symbol,i="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=i&&n[t]||(i?n:E)("Symbol."+t))}).store=e})),ot=y.f,at=it("toStringTag"),st=function(t,e,n){t&&!w(t=n?t:t.prototype,at)&&ot(t,at,{configurable:!0,value:e})},ct={f:it},ut=y.f,lt=function(t){var e=i.Symbol||(i.Symbol={});"_"==t.charAt(0)||t in e||ut(e,t,{value:ct.f(t)})},ft={f:Object.getOwnPropertySymbols},ht={f:{}.propertyIsEnumerable},dt=Array.isArray||function(t){return"Array"==N(t)},pt=l?Object.defineProperties:function(t,e){c(t);for(var n,r=et(e),i=r.length,o=0;i>o;)y.f(t,n=r[o++],e[n]);return t},vt=r.document,gt=vt&&vt.documentElement,yt=$("IE_PROTO"),mt=function(){},_t=function(){var t,e=d("iframe"),n=tt.length;for(e.style.display="none",gt.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),_t=t.F;n--;)delete _t.prototype[tt[n]];return _t()},St=Object.create||function(t,e){var n;return null!==t?(mt.prototype=c(t),n=new mt,mt.prototype=null,n[yt]=t):n=_t(),void 0===e?n:pt(n,e)},wt=tt.concat("length","prototype"),bt={f:Object.getOwnPropertyNames||function(t){return X(t,wt)}},It=bt.f,xt={}.toString,kt="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Ot={f:function(t){return kt&&"[object Window]"==xt.call(t)?function(t){try{return It(t)}catch(t){return kt.slice()}}(t):It(M(t))}},Ct=Object.getOwnPropertyDescriptor,Et={f:l?Ct:function(t,e){if(t=M(t),e=v(e,!0),p)try{return Ct(t,e)}catch(t){}if(w(t,e))return m(!ht.f.call(t,e),t[e])}},jt=j.KEY,Tt=Et.f,At=y.f,Dt=Ot.f,Pt=r.Symbol,Lt=r.JSON,Ft=Lt&&Lt.stringify,Ut=it("_hidden"),zt=it("toPrimitive"),Nt={}.propertyIsEnumerable,Rt=W("symbol-registry"),Mt=W("symbols"),Bt=W("op-symbols"),Gt=Object.prototype,Zt="function"==typeof Pt&&!!ft.f,Ht=r.QObject,qt=!Ht||!Ht.prototype||!Ht.prototype.findChild,Kt=l&&u((function(){return 7!=St(At({},"a",{get:function(){return At(this,"a",{value:7}).a}})).a}))?function(t,e,n){var r=Tt(Gt,e);r&&delete Gt[e],At(t,e,n),r&&t!==Gt&&At(Gt,e,r)}:At,Vt=function(t){var e=Mt[t]=St(Pt.prototype);return e._k=t,e},Wt=Zt&&"symbol"==typeof Pt.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof Pt},Jt=function(t,e,n){return t===Gt&&Jt(Bt,e,n),c(t),e=v(e,!0),c(n),w(Mt,e)?(n.enumerable?(w(t,Ut)&&t[Ut][e]&&(t[Ut][e]=!1),n=St(n,{enumerable:m(0,!1)})):(w(t,Ut)||At(t,Ut,m(1,{})),t[Ut][e]=!0),Kt(t,e,n)):At(t,e,n)},$t=function(t,e){c(t);for(var n,r=function(t){var e=et(t),n=ft.f;if(n)for(var r,i=n(t),o=ht.f,a=0;i.length>a;)o.call(t,r=i[a++])&&e.push(r);return e}(e=M(e)),i=0,o=r.length;o>i;)Jt(t,n=r[i++],e[n]);return t},Qt=function(t){var e=Nt.call(this,t=v(t,!0));return!(this===Gt&&w(Mt,t)&&!w(Bt,t))&&(!(e||!w(this,t)||!w(Mt,t)||w(this,Ut)&&this[Ut][t])||e)},Yt=function(t,e){if(t=M(t),e=v(e,!0),t!==Gt||!w(Mt,e)||w(Bt,e)){var n=Tt(t,e);return!n||!w(Mt,e)||w(t,Ut)&&t[Ut][e]||(n.enumerable=!0),n}},Xt=function(t){for(var e,n=Dt(M(t)),r=[],i=0;n.length>i;)w(Mt,e=n[i++])||e==Ut||e==jt||r.push(e);return r},te=function(t){for(var e,n=t===Gt,r=Dt(n?Bt:M(t)),i=[],o=0;r.length>o;)!w(Mt,e=r[o++])||n&&!w(Gt,e)||i.push(Mt[e]);return i};Zt||(rt((Pt=function(){if(this instanceof Pt)throw TypeError("Symbol is not a constructor!");var t=E(arguments.length>0?arguments[0]:void 0),e=function(n){this===Gt&&e.call(Bt,n),w(this,Ut)&&w(this[Ut],t)&&(this[Ut][t]=!1),Kt(this,t,m(1,n))};return l&&qt&&Kt(Gt,t,{configurable:!0,set:e}),Vt(t)}).prototype,"toString",(function(){return this._k})),Et.f=Yt,y.f=Jt,bt.f=Ot.f=Xt,ht.f=Qt,ft.f=te,ct.f=function(t){return Vt(it(t))}),I(I.G+I.W+I.F*!Zt,{Symbol:Pt});for(var ee="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;ee.length>ne;)it(ee[ne++]);for(var re=et(it.store),ie=0;re.length>ie;)lt(re[ie++]);I(I.S+I.F*!Zt,"Symbol",{for:function(t){return w(Rt,t+="")?Rt[t]:Rt[t]=Pt(t)},keyFor:function(t){if(!Wt(t))throw TypeError(t+" is not a symbol!");for(var e in Rt)if(Rt[e]===t)return e},useSetter:function(){qt=!0},useSimple:function(){qt=!1}}),I(I.S+I.F*!Zt,"Object",{create:function(t,e){return void 0===e?St(t):$t(St(t),e)},defineProperty:Jt,defineProperties:$t,getOwnPropertyDescriptor:Yt,getOwnPropertyNames:Xt,getOwnPropertySymbols:te});var oe=u((function(){ft.f(1)}));I(I.S+I.F*oe,"Object",{getOwnPropertySymbols:function(t){return ft.f(U(t))}}),Lt&&I(I.S+I.F*(!Zt||u((function(){var t=Pt();return"[null]"!=Ft([t])||"{}"!=Ft({a:t})||"{}"!=Ft(Object(t))}))),"JSON",{stringify:function(t){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=e=r[1],(s(e)||void 0!==t)&&!Wt(t))return dt(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Wt(e))return e}),r[1]=e,Ft.apply(Lt,r)}}),Pt.prototype[zt]||_(Pt.prototype,zt,Pt.prototype.valueOf),st(Pt,"Symbol"),st(Math,"Math",!0),st(r.JSON,"JSON",!0);var ae=i.Object.getOwnPropertySymbols,se=Et.f;T("getOwnPropertyDescriptor",(function(){return function(t,e){return se(M(t),e)}}));var ce=i.Object,ue=function(t,e){return ce.getOwnPropertyDescriptor(t,e)},le=r.Reflect,fe=le&&le.ownKeys||function(t){var e=bt.f(c(t)),n=ft.f;return n?e.concat(n(t)):e},he=function(t,e,n){e in t?y.f(t,e,m(0,n)):t[e]=n};I(I.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,r=M(t),i=Et.f,o=fe(r),a={},s=0;o.length>s;)void 0!==(n=i(r,e=o[s++]))&&he(a,e,n);return a}});var de=i.Object.getOwnPropertyDescriptors;I(I.S+I.F*!l,"Object",{defineProperties:pt});var pe=i.Object,ve=function(t,e){return pe.defineProperties(t,e)},ge=n((function(t){t.exports=function(t,e,n){return e in t?k(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.default=t.exports,t.exports.__esModule=!0})),ye=e(ge),me=e(n((function(t){function e(t,e){var n=nt(t);if(ae){var r=ae(t);e&&(r=r.filter((function(e){return ue(t,e).enumerable}))),n.push.apply(n,r)}return n}t.exports=function(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach((function(e){ge(t,e,r[e])})):de?ve(t,de(r)):e(Object(r)).forEach((function(e){k(t,e,ue(r,e))}))}return t},t.exports.default=t.exports,t.exports.__esModule=!0}))),_e=e(n((function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.default=t.exports,t.exports.__esModule=!0}))),Se=e(n((function(t){function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),k(t,r.key,r)}}t.exports=function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t},t.exports.default=t.exports,t.exports.__esModule=!0}))),we=i.JSON||(i.JSON={stringify:JSON.stringify}),be=function(t){return we.stringify.apply(we,arguments)},Ie=new RegExp("%[a-f0-9]{2}","gi"),xe=new RegExp("(%[a-f0-9]{2})+","gi");function ke(t,e){try{return decodeURIComponent(t.join(""))}catch(t){}if(1===t.length)return t;e=e||1;var n=t.slice(0,e),r=t.slice(e);return Array.prototype.concat.call([],ke(n),ke(r))}function Oe(t){try{return decodeURIComponent(t)}catch(r){for(var e=t.match(Ie),n=1;n<e.length;n++)e=(t=ke(e,n).join("")).match(Ie);return t}}var Ce=function(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch(e){return function(t){for(var e={"%FE%FF":"ï¿½ï¿½","%FF%FE":"ï¿½ï¿½"},n=xe.exec(t);n;){try{e[n[0]]=decodeURIComponent(n[0])}catch(t){var r=Oe(n[0]);r!==n[0]&&(e[n[0]]=r)}n=xe.exec(t)}e["%C2"]="ï¿½";for(var i=Object.keys(e),o=0;o<i.length;o++){var a=i[o];t=t.replace(new RegExp(a,"g"),e[a])}return t}(t)}},Ee=(t,e)=>{if("string"!=typeof t||"string"!=typeof e)throw new TypeError("Expected the arguments to be of type `string`");if(""===e)return[t];const n=t.indexOf(e);return-1===n?[t]:[t.slice(0,n),t.slice(n+e.length)]},je=function(t,e){for(var n={},r=Object.keys(t),i=Array.isArray(e),o=0;o<r.length;o++){var a=r[o],s=t[a];(i?-1!==e.indexOf(a):e(a,s,t))&&(n[a]=s)}return n},Te=n((function(t,e){function n(t){if("string"!=typeof t||1!==t.length)throw new TypeError("arrayFormatSeparator must be single character string")}function r(t,e){return e.encode?e.strict?encodeURIComponent(t).replace(/[!'()*]/g,t=>"%"+t.charCodeAt(0).toString(16).toUpperCase()):encodeURIComponent(t):t}function i(t,e){return e.decode?Ce(t):t}function o(t){const e=t.indexOf("#");return-1!==e&&(t=t.slice(0,e)),t}function a(t){const e=(t=o(t)).indexOf("?");return-1===e?"":t.slice(e+1)}function s(t,e){return e.parseNumbers&&!Number.isNaN(Number(t))&&"string"==typeof t&&""!==t.trim()?t=Number(t):!e.parseBooleans||null===t||"true"!==t.toLowerCase()&&"false"!==t.toLowerCase()||(t="true"===t.toLowerCase()),t}function c(t,e){n((e=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},e)).arrayFormatSeparator);const r=function(t){let e;switch(t.arrayFormat){case"index":return(t,n,r)=>{e=/\[(\d*)\]$/.exec(t),t=t.replace(/\[\d*\]$/,""),e?(void 0===r[t]&&(r[t]={}),r[t][e[1]]=n):r[t]=n};case"bracket":return(t,n,r)=>{e=/(\[\])$/.exec(t),t=t.replace(/\[\]$/,""),e?void 0!==r[t]?r[t]=[].concat(r[t],n):r[t]=[n]:r[t]=n};case"comma":case"separator":return(e,n,r)=>{const o="string"==typeof n&&n.includes(t.arrayFormatSeparator),a="string"==typeof n&&!o&&i(n,t).includes(t.arrayFormatSeparator);n=a?i(n,t):n;const s=o||a?n.split(t.arrayFormatSeparator).map(e=>i(e,t)):null===n?n:i(n,t);r[e]=s};default:return(t,e,n)=>{void 0!==n[t]?n[t]=[].concat(n[t],e):n[t]=e}}}(e),o=Object.create(null);if("string"!=typeof t)return o;if(!(t=t.trim().replace(/^[?#&]/,"")))return o;for(const n of t.split("&")){if(""===n)continue;let[t,a]=Ee(e.decode?n.replace(/\+/g," "):n,"=");a=void 0===a?null:["comma","separator"].includes(e.arrayFormat)?a:i(a,e),r(i(t,e),a,o)}for(const t of Object.keys(o)){const n=o[t];if("object"==typeof n&&null!==n)for(const t of Object.keys(n))n[t]=s(n[t],e);else o[t]=s(n,e)}return!1===e.sort?o:(!0===e.sort?Object.keys(o).sort():Object.keys(o).sort(e.sort)).reduce((t,e)=>{const n=o[e];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?t[e]=function t(e){return Array.isArray(e)?e.sort():"object"==typeof e?t(Object.keys(e)).sort((t,e)=>Number(t)-Number(e)).map(t=>e[t]):e}(n):t[e]=n,t},Object.create(null))}e.extract=a,e.parse=c,e.stringify=(t,e)=>{if(!t)return"";n((e=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},e)).arrayFormatSeparator);const i=n=>e.skipNull&&(t=>null==t)(t[n])||e.skipEmptyString&&""===t[n],o=function(t){switch(t.arrayFormat){case"index":return e=>(n,i)=>{const o=n.length;return void 0===i||t.skipNull&&null===i||t.skipEmptyString&&""===i?n:null===i?[...n,[r(e,t),"[",o,"]"].join("")]:[...n,[r(e,t),"[",r(o,t),"]=",r(i,t)].join("")]};case"bracket":return e=>(n,i)=>void 0===i||t.skipNull&&null===i||t.skipEmptyString&&""===i?n:null===i?[...n,[r(e,t),"[]"].join("")]:[...n,[r(e,t),"[]=",r(i,t)].join("")];case"comma":case"separator":return e=>(n,i)=>null==i||0===i.length?n:0===n.length?[[r(e,t),"=",r(i,t)].join("")]:[[n,r(i,t)].join(t.arrayFormatSeparator)];default:return e=>(n,i)=>void 0===i||t.skipNull&&null===i||t.skipEmptyString&&""===i?n:null===i?[...n,r(e,t)]:[...n,[r(e,t),"=",r(i,t)].join("")]}}(e),a={};for(const e of Object.keys(t))i(e)||(a[e]=t[e]);const s=Object.keys(a);return!1!==e.sort&&s.sort(e.sort),s.map(n=>{const i=t[n];return void 0===i?"":null===i?r(n,e):Array.isArray(i)?i.reduce(o(n),[]).join("&"):r(n,e)+"="+r(i,e)}).filter(t=>t.length>0).join("&")},e.parseUrl=(t,e)=>{e=Object.assign({decode:!0},e);const[n,r]=Ee(t,"#");return Object.assign({url:n.split("?")[0]||"",query:c(a(t),e)},e&&e.parseFragmentIdentifier&&r?{fragmentIdentifier:i(r,e)}:{})},e.stringifyUrl=(t,n)=>{n=Object.assign({encode:!0,strict:!0},n);const i=o(t.url).split("?")[0]||"",a=e.extract(t.url),s=e.parse(a,{sort:!1}),c=Object.assign(s,t.query);let u=e.stringify(c,n);u&&(u="?"+u);let l=function(t){let e="";const n=t.indexOf("#");return-1!==n&&(e=t.slice(n)),e}(t.url);return t.fragmentIdentifier&&(l="#"+r(t.fragmentIdentifier,n)),`${i}${u}${l}`},e.pick=(t,n,r)=>{r=Object.assign({parseFragmentIdentifier:!0},r);const{url:i,query:o,fragmentIdentifier:a}=e.parseUrl(t,r);return e.stringifyUrl({url:i,query:je(o,n),fragmentIdentifier:a},r)},e.exclude=(t,n,r)=>{const i=Array.isArray(n)?t=>!n.includes(t):(t,e)=>!n(t,e);return e.pick(t,i,r)}})),Ae=(Te.extract,Te.parse,Te.stringify,Te.parseUrl,Te.stringifyUrl,Te.pick,Te.exclude,function(){function t(){_e(this,t)}return Se(t,[{key:"getAuthorization",value:function(t){return"Basic ".concat(t)}},{key:"getHeaders",value:function(t){return t?me(me({},t.contentType?{"Content-Type":t.contentType}:{}),t.basicAuthKey?{Authorization:this.getAuthorization(t.basicAuthKey)}:{}):{}}},{key:"get",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=Te.stringifyUrl({url:t,query:e}),o=new De(i,{},{headers:this.getHeaders(r)});o.send(n)}},{key:"post",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0,i=Te.stringifyUrl({url:t,query:e.params?e.params:{}}),o=new De(i,be(e.body),{method:"POST",headers:this.getHeaders(me({contentType:"application/json;charset=UTF-8"},n))});o.send(r)}}]),t}()),De=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.url=t,this.data=e,this.options=n};De.prototype.send=function(t){var e=this;if(!!window.XDomainRequest){var n=new window.XDomainRequest;xhr.open(this.options.method||"GET",this.url,!0),this.options.headers&&nt(this.options.headers).forEach((function(t){n.setRequestHeader(t,e.options.headers[t])})),n.onload=function(){t(200,n.responseText)},n.onerror=function(){t(500,n.responseText)},n.withCredentials=!0,n.ontimeout=function(){},n.onprogress=function(){},n.send(Te.stringify(this.data))}else{var r=new XMLHttpRequest;r.withCredentials=!0,r.open(this.options.method||"GET",this.url),this.options.headers&&nt(this.options.headers).forEach((function(t){r.setRequestHeader(t,e.options.headers[t])})),r.onload=function(){r.status>=200&&r.status<300?t(r.status,r.response):t(r.status,r.statusText)},r.onerror=function(){return t(r.status,r.statusText)},r.send(this.data)}};var Pe={eventRetryDelayMillis:500,eventUploadPeriodMillis:500,eventUploadThreshold:1,uploadBatchSize:1,maxRetries:3,debug:!1,storageExpirationDays:365,onlySecureCookie:!0,allowGAClientId:!0,shouldCheckZeotapVendorConsent:!1,persistenceInCookieStorage:!1,maxEventsQueuedTillConsentUnresolved:10,includeTCFString:!1},Le=["email","cellno","loginid","fpuid","cellno_cc","cellno_e164"],Fe=["cellno_without_country_code","cellno_e164","cellno_with_country_code"],Ue={email_sha256_lowercase:{id:"email",type:"sha256_lowercase"},email_sha256_uppercase:{id:"email",type:"sha256_uppercase"},email_md5_lowercase:{id:"email",type:"md5_lowercase"},email_md5_uppercase:{id:"email",type:"md5_uppercase"},email_sha1_lowercase:{id:"email",type:"sha1_lowercase"},email_sha1_uppercase:{id:"email",type:"sha1_uppercase"},cellno_without_country_code_sha256:{id:"cellno_without_country_code",type:"sha256"},cellno_without_country_code_md5:{id:"cellno_without_country_code",type:"md5"},cellno_without_country_code_sha1:{id:"cellno_without_country_code",type:"sha1"},cellno_with_country_code_sha256:{id:"cellno_with_country_code",type:"sha256"},cellno_with_country_code_md5:{id:"cellno_with_country_code",type:"md5"},cellno_with_country_code_sha1:{id:"cellno_with_country_code",type:"sha1"},cellno_e164_sha256:{id:"cellno_e164",type:"sha256"},cellno_e164_md5:{id:"cellno_e164",type:"md5"},cellno_e164_sha1:{id:"cellno_e164",type:"sha1"},loginid_sha256_lowercase:{id:"loginid",type:"sha256_lowercase"},loginid_sha256_uppercase:{id:"loginid",type:"sha256_uppercase"},loginid_md5_lowercase:{id:"loginid",type:"md5_lowercase"},loginid_md5_uppercase:{id:"loginid",type:"md5_uppercase"},loginid_sha1_lowercase:{id:"loginid",type:"sha1_lowercase"},loginid_sha1_uppercase:{id:"loginid",type:"sha1_uppercase"},fpuid:{id:"fpuid",type:"fpuid"}},ze="setUserIdentities",Ne="updateUserIdentities";lt("asyncIterator"),lt("observable");var Re=i.Symbol,Me={},Be={};_(Be,it("iterator"),(function(){return this}));var Ge,Ze=function(t,e,n){t.prototype=St(Be,{next:m(1,n)}),st(t,e+" Iterator")},He=$("IE_PROTO"),qe=Object.prototype,Ke=Object.getPrototypeOf||function(t){return t=U(t),w(t,He)?t[He]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?qe:null},Ve=it("iterator"),We=!([].keys&&"next"in[].keys()),Je=function(){return this},$e=function(t,e,n,r,i,o,a){Ze(n,e,r);var s,c,u,l=function(t){if(!We&&t in p)return p[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},f=e+" Iterator",h="values"==i,d=!1,p=t.prototype,v=p[Ve]||p["@@iterator"]||i&&p[i],g=v||l(i),y=i?h?l("entries"):g:void 0,m="Array"==e&&p.entries||v;if(m&&(u=Ke(m.call(new t)))!==Object.prototype&&u.next&&st(u,f,!0),h&&v&&"values"!==v.name&&(d=!0,g=function(){return v.call(this)}),a&&(We||d||!p[Ve])&&_(p,Ve,g),Me[e]=g,Me[f]=Je,i)if(s={values:h?g:l("values"),keys:o?g:l("keys"),entries:y},a)for(c in s)c in p||rt(p,c,s[c]);else I(I.P+I.F*(We||d),e,s);return s},Qe=(Ge=!0,function(t,e){var n,r,i=String(F(t)),o=Z(e),a=i.length;return o<0||o>=a?Ge?"":void 0:(n=i.charCodeAt(o))<55296||n>56319||o+1===a||(r=i.charCodeAt(o+1))<56320||r>57343?Ge?i.charAt(o):n:Ge?i.slice(o,o+2):r-56320+(n-55296<<10)+65536});$e(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=Qe(e,n),this._i+=t.length,{value:t,done:!1})}));var Ye=function(t,e){return{value:e,done:!!t}};$e(Array,"Array",(function(t,e){this._t=M(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,Ye(1)):Ye(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values");Me.Arguments=Me.Array;for(var Xe=it("toStringTag"),tn="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),en=0;en<tn.length;en++){var nn=tn[en],rn=r[nn],on=rn&&rn.prototype;on&&!on[Xe]&&_(on,Xe,nn),Me[nn]=Me.Array}var an=ct.f("iterator");I(I.S,"Array",{isArray:dt});var sn=i.Array.isArray,cn=it("toStringTag"),un="Arguments"==N(function(){return arguments}()),ln=function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),cn))?n:un?N(e):"Object"==(r=N(e))&&"function"==typeof e.callee?"Arguments":r},fn=it("iterator"),hn=i.getIteratorMethod=function(t){if(null!=t)return t[fn]||t["@@iterator"]||Me[ln(t)]},dn=i.getIterator=function(t){var e=hn(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return c(e.call(t))},pn=function(t,e,n,r){try{return r?e(c(n)[0],n[1]):e(n)}catch(e){var i=t.return;throw void 0!==i&&c(i.call(t)),e}},vn=it("iterator"),gn=Array.prototype,yn=function(t){return void 0!==t&&(Me.Array===t||gn[vn]===t)},mn=it("iterator"),_n=!1;try{var Sn=[7][mn]();Sn.return=function(){_n=!0},Array.from(Sn,(function(){throw 2}))}catch(t){}var wn=function(t,e){if(!e&&!_n)return!1;var n=!1;try{var r=[7],i=r[mn]();i.next=function(){return{done:n=!0}},r[mn]=function(){return i},t(r)}catch(t){}return n};I(I.S+I.F*!wn((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,r,i,o=U(t),s="function"==typeof this?this:Array,c=arguments.length,u=c>1?arguments[1]:void 0,l=void 0!==u,f=0,h=hn(o);if(l&&(u=a(u,c>2?arguments[2]:void 0,2)),null==h||s==Array&&yn(h))for(n=new s(e=q(o.length));e>f;f++)he(n,f,l?u(o[f],f):o[f]);else for(i=h.call(o),n=new s;!(r=i.next()).done;f++)he(n,f,l?pn(i,u,[r.value,f],!0):r.value);return n.length=f,n}});var bn=i.Array.from,In=n((function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r},t.exports.default=t.exports,t.exports.__esModule=!0}));e(In);var xn=n((function(t){t.exports=function(t,e){if(t){if("string"==typeof t)return In(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?bn(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?In(t,e):void 0}},t.exports.default=t.exports,t.exports.__esModule=!0}));e(xn);var kn=e(n((function(t){t.exports=function(t,e){var n;if(void 0===Re||null==t[an]){if(sn(t)||(n=xn(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=dn(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}},t.exports.default=t.exports,t.exports.__esModule=!0}))),On=function(){this.listeners={}};On.prototype.listeners=null,On.prototype.addEventListener=function(t,e){t in this.listeners||(this.listeners[t]=[]),this.listeners[t].push(e)},On.prototype.removeEventListener=function(t,e){if(t in this.listeners)for(var n=this.listeners[t],r=0,i=n.length;r<i;r++)if(n[r]===e)return void n.splice(r,1)},On.prototype.removeAll=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=nt(this.listeners);if(t)this.listeners[t]=[];else{var n,r=kn(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.listeners[i]=[]}}catch(t){r.e(t)}finally{r.f()}}},On.prototype.dispatchEvent=function(t){if(!(t.type in this.listeners))return!0;for(var e=this.listeners[t.type].slice(),n=0,r=e.length;n<r;n++)e[n].call(this,t);return!t.defaultPrevented};var Cn=e(n((function(t){function e(n){return"function"==typeof Re&&"symbol"==typeof an?(t.exports=e=function(t){return typeof t},t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=e=function(t){return t&&"function"==typeof Re&&t.constructor===Re&&t!==Re.prototype?"symbol":typeof t},t.exports.default=t.exports,t.exports.__esModule=!0),e(n)}t.exports=e,t.exports.default=t.exports,t.exports.__esModule=!0}))),En=n((function(t){t.exports=function(t){if(sn(t))return t},t.exports.default=t.exports,t.exports.__esModule=!0}));e(En);var jn=it("iterator"),Tn=i.isIterable=function(t){var e=Object(t);return void 0!==e[jn]||"@@iterator"in e||Me.hasOwnProperty(ln(e))},An=n((function(t){t.exports=function(t,e){if(void 0!==Re&&Tn(Object(t))){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=dn(t);!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}},t.exports.default=t.exports,t.exports.__esModule=!0}));e(An);var Dn=n((function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0}));e(Dn);var Pn=e(n((function(t){t.exports=function(t,e){return En(t)||An(t,e)||xn(t,e)||Dn()},t.exports.default=t.exports,t.exports.__esModule=!0}))),Ln=n((function(t){t.exports=function(t){if(sn(t))return In(t)},t.exports.default=t.exports,t.exports.__esModule=!0}));e(Ln);var Fn=n((function(t){t.exports=function(t){if(void 0!==Re&&Tn(Object(t)))return bn(t)},t.exports.default=t.exports,t.exports.__esModule=!0}));e(Fn);var Un=n((function(t){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0}));e(Un);var zn,Nn=e(n((function(t){t.exports=function(t){return Ln(t)||Fn(t)||xn(t)||Un()},t.exports.default=t.exports,t.exports.__esModule=!0}))),Rn=(zn=Object.freeze({__proto__:null,default:{}}))&&zn.default||zn,Mn=n((function(e,n){var r;e.exports=(r=r||function(e,n){var r;if("undefined"!=typeof window&&window.crypto&&(r=window.crypto),"undefined"!=typeof self&&self.crypto&&(r=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(r=globalThis.crypto),!r&&"undefined"!=typeof window&&window.msCrypto&&(r=window.msCrypto),!r&&void 0!==t&&t.crypto&&(r=t.crypto),!r)try{r=Rn}catch(t){}var i=function(){if(r){if("function"==typeof r.getRandomValues)try{return r.getRandomValues(new Uint32Array(1))[0]}catch(t){}if("function"==typeof r.randomBytes)try{return r.randomBytes(4).readInt32LE()}catch(t){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function t(){}return function(e){var n;return t.prototype=e,n=new t,t.prototype=null,n}}(),a={},s=a.lib={},c=s.Base={extend:function(t){var e=o(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},u=s.WordArray=c.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||f).stringify(this)},concat:function(t){var e=this.words,n=t.words,r=this.sigBytes,i=t.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var a=n[o>>>2]>>>24-o%4*8&255;e[r+o>>>2]|=a<<24-(r+o)%4*8}else for(var s=0;s<i;s+=4)e[r+s>>>2]=n[s>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var t=c.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],n=0;n<t;n+=4)e.push(i());return new u.init(e,t)}}),l=a.enc={},f=l.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++){var o=e[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new u.init(n,e/2)}},h=l.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++){var o=e[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new u.init(n,e)}},d=l.Utf8={stringify:function(t){try{return decodeURIComponent(escape(h.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return h.parse(unescape(encodeURIComponent(t)))}},p=s.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=d.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var n,r=this._data,i=r.words,o=r.sigBytes,a=this.blockSize,s=o/(4*a),c=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*a,l=e.min(4*c,o);if(c){for(var f=0;f<c;f+=a)this._doProcessBlock(i,f);n=i.splice(0,c),r.sigBytes-=l}return new u.init(n,l)},clone:function(){var t=c.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),v=(s.Hasher=p.extend({cfg:c.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new v.HMAC.init(t,n).finalize(e)}}}),a.algo={});return a}(Math),r)})),Bn=n((function(t,e){var n,r,i,o,a,s,c,u;t.exports=(r=(n=u=Mn).lib,i=r.WordArray,o=r.Hasher,a=n.algo,s=[],c=a.SHA1=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],a=n[3],c=n[4],u=0;u<80;u++){if(u<16)s[u]=0|t[e+u];else{var l=s[u-3]^s[u-8]^s[u-14]^s[u-16];s[u]=l<<1|l>>>31}var f=(r<<5|r>>>27)+c+s[u];f+=u<20?1518500249+(i&o|~i&a):u<40?1859775393+(i^o^a):u<60?(i&o|i&a|o&a)-1894007588:(i^o^a)-899497514,c=a,a=o,o=i<<30|i>>>2,i=r,r=f}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+c|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,r=8*t.sigBytes;return e[r>>>5]|=128<<24-r%32,e[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),e[15+(r+64>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=o.clone.call(this);return t._hash=this._hash.clone(),t}}),n.SHA1=o._createHelper(c),n.HmacSHA1=o._createHmacHelper(c),u.SHA1)})),Gn=n((function(t,e){var n;t.exports=(n=Mn,function(t){var e=n,r=e.lib,i=r.WordArray,o=r.Hasher,a=e.algo,s=[],c=[];!function(){function e(e){for(var n=t.sqrt(e),r=2;r<=n;r++)if(!(e%r))return!1;return!0}function n(t){return 4294967296*(t-(0|t))|0}for(var r=2,i=0;i<64;)e(r)&&(i<8&&(s[i]=n(t.pow(r,.5))),c[i]=n(t.pow(r,1/3)),i++),r++}();var u=[],l=a.SHA256=o.extend({_doReset:function(){this._hash=new i.init(s.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],l=n[5],f=n[6],h=n[7],d=0;d<64;d++){if(d<16)u[d]=0|t[e+d];else{var p=u[d-15],v=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,g=u[d-2],y=(g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10;u[d]=v+u[d-7]+y+u[d-16]}var m=r&i^r&o^i&o,_=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),S=h+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&l^~s&f)+c[d]+u[d];h=f,f=l,l=s,s=a+S|0,a=o,o=i,i=r,r=S+(_+m)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0,n[5]=n[5]+l|0,n[6]=n[6]+f|0,n[7]=n[7]+h|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=t.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=o.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=o._createHelper(l),e.HmacSHA256=o._createHmacHelper(l)}(Math),n.SHA256)})),Zn=n((function(t,e){var n;t.exports=(n=Mn,function(t){var e=n,r=e.lib,i=r.WordArray,o=r.Hasher,a=e.algo,s=[];!function(){for(var e=0;e<64;e++)s[e]=4294967296*t.abs(t.sin(e+1))|0}();var c=a.MD5=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,e){for(var n=0;n<16;n++){var r=e+n,i=t[r];t[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var o=this._hash.words,a=t[e+0],c=t[e+1],d=t[e+2],p=t[e+3],v=t[e+4],g=t[e+5],y=t[e+6],m=t[e+7],_=t[e+8],S=t[e+9],w=t[e+10],b=t[e+11],I=t[e+12],x=t[e+13],k=t[e+14],O=t[e+15],C=o[0],E=o[1],j=o[2],T=o[3];C=u(C,E,j,T,a,7,s[0]),T=u(T,C,E,j,c,12,s[1]),j=u(j,T,C,E,d,17,s[2]),E=u(E,j,T,C,p,22,s[3]),C=u(C,E,j,T,v,7,s[4]),T=u(T,C,E,j,g,12,s[5]),j=u(j,T,C,E,y,17,s[6]),E=u(E,j,T,C,m,22,s[7]),C=u(C,E,j,T,_,7,s[8]),T=u(T,C,E,j,S,12,s[9]),j=u(j,T,C,E,w,17,s[10]),E=u(E,j,T,C,b,22,s[11]),C=u(C,E,j,T,I,7,s[12]),T=u(T,C,E,j,x,12,s[13]),j=u(j,T,C,E,k,17,s[14]),C=l(C,E=u(E,j,T,C,O,22,s[15]),j,T,c,5,s[16]),T=l(T,C,E,j,y,9,s[17]),j=l(j,T,C,E,b,14,s[18]),E=l(E,j,T,C,a,20,s[19]),C=l(C,E,j,T,g,5,s[20]),T=l(T,C,E,j,w,9,s[21]),j=l(j,T,C,E,O,14,s[22]),E=l(E,j,T,C,v,20,s[23]),C=l(C,E,j,T,S,5,s[24]),T=l(T,C,E,j,k,9,s[25]),j=l(j,T,C,E,p,14,s[26]),E=l(E,j,T,C,_,20,s[27]),C=l(C,E,j,T,x,5,s[28]),T=l(T,C,E,j,d,9,s[29]),j=l(j,T,C,E,m,14,s[30]),C=f(C,E=l(E,j,T,C,I,20,s[31]),j,T,g,4,s[32]),T=f(T,C,E,j,_,11,s[33]),j=f(j,T,C,E,b,16,s[34]),E=f(E,j,T,C,k,23,s[35]),C=f(C,E,j,T,c,4,s[36]),T=f(T,C,E,j,v,11,s[37]),j=f(j,T,C,E,m,16,s[38]),E=f(E,j,T,C,w,23,s[39]),C=f(C,E,j,T,x,4,s[40]),T=f(T,C,E,j,a,11,s[41]),j=f(j,T,C,E,p,16,s[42]),E=f(E,j,T,C,y,23,s[43]),C=f(C,E,j,T,S,4,s[44]),T=f(T,C,E,j,I,11,s[45]),j=f(j,T,C,E,O,16,s[46]),C=h(C,E=f(E,j,T,C,d,23,s[47]),j,T,a,6,s[48]),T=h(T,C,E,j,m,10,s[49]),j=h(j,T,C,E,k,15,s[50]),E=h(E,j,T,C,g,21,s[51]),C=h(C,E,j,T,I,6,s[52]),T=h(T,C,E,j,p,10,s[53]),j=h(j,T,C,E,w,15,s[54]),E=h(E,j,T,C,c,21,s[55]),C=h(C,E,j,T,_,6,s[56]),T=h(T,C,E,j,O,10,s[57]),j=h(j,T,C,E,y,15,s[58]),E=h(E,j,T,C,x,21,s[59]),C=h(C,E,j,T,v,6,s[60]),T=h(T,C,E,j,b,10,s[61]),j=h(j,T,C,E,d,15,s[62]),E=h(E,j,T,C,S,21,s[63]),o[0]=o[0]+C|0,o[1]=o[1]+E|0,o[2]=o[2]+j|0,o[3]=o[3]+T|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;n[i>>>5]|=128<<24-i%32;var o=t.floor(r/4294967296),a=r;n[15+(i+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),n[14+(i+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),e.sigBytes=4*(n.length+1),this._process();for(var s=this._hash,c=s.words,u=0;u<4;u++){var l=c[u];c[u]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return s},clone:function(){var t=o.clone.call(this);return t._hash=this._hash.clone(),t}});function u(t,e,n,r,i,o,a){var s=t+(e&n|~e&r)+i+a;return(s<<o|s>>>32-o)+e}function l(t,e,n,r,i,o,a){var s=t+(e&r|n&~r)+i+a;return(s<<o|s>>>32-o)+e}function f(t,e,n,r,i,o,a){var s=t+(e^n^r)+i+a;return(s<<o|s>>>32-o)+e}function h(t,e,n,r,i,o,a){var s=t+(n^(e|~r))+i+a;return(s<<o|s>>>32-o)+e}e.MD5=o._createHelper(c),e.HmacMD5=o._createHmacHelper(c)}(Math),n.MD5)})),Hn=function(t){this.value="string"!=typeof t?"".concat(t):t.trim()};Hn.prototype.sha256=function(){return Gn(this.value).toString()},Hn.prototype.sha1=function(){return Bn(this.value).toString()},Hn.prototype.md5=function(){return Zn(this.value).toString()},Hn.prototype.sha256u=function(){return Gn(this.value.toUpperCase()).toString()},Hn.prototype.sha256l=function(){return Gn(this.value.toLowerCase()).toString()},Hn.prototype.sha1u=function(){return Bn(this.value.toUpperCase()).toString()},Hn.prototype.sha1l=function(){return Bn(this.value.toLowerCase()).toString()},Hn.prototype.md5u=function(){return Zn(this.value.toUpperCase()).toString()},Hn.prototype.md5l=function(){return Zn(this.value.toLowerCase()).toString()},Hn.prototype.all=function(){return{sha256u:this.sha256u(),sha256l:this.sha256l()}};var qn=function(){if("undefined"!=typeof console){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(t=console).log.apply(t,Nn(["[zeotap]"].concat(n)))}};var Kn=function(t){switch(Object.prototype.toString.call(t)){case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object Error]":return"error"}return null===t?"null":void 0===t?"undefined":t!=t?"nan":t&&1===t.nodeType?"element":"undefined"!=typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(t)?"buffer":(t=t.valueOf?t.valueOf():Object.prototype.valueOf.apply(t),Cn(t))},Vn=function(t){return null==t},Wn=function(t){return Vn(t)||"string"===Kn(t)&&t.length<=0},Jn=function(t){return String.prototype.replace.call(t,/[\(\)\+\-]/gi,"")},$n=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:31536e3,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=r?escape(String.prototype.trim.call(t))+"="+escape(e):escape(String.prototype.trim.call(t))+"="+escape(e)+";max-age="+n+";";document.cookie=i},Qn=function(t){for(var e=escape(String.prototype.trim.call(t))+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(e))return i.substring(e.length,i.length)}return null},Yn=function(t){$n(t,"",-1)},Xn=function(t){return tr()?window.localStorage.getItem(t):Qn(t)},tr=function(){try{if(window.localStorage){return window.localStorage.setItem("rtesting","rtesting"),window.localStorage.removeItem("rtesting"),!0}return!1}catch(t){return!1}},er=function(){try{if(window.sessionStorage){return window.sessionStorage.setItem("rtesting","rtesting"),window.sessionStorage.removeItem("rtesting"),!0}return!1}catch(t){return!1}},nr=function(t,e){return"string"==typeof e&&""!==e?ye({},t,e):{}},rr=function(t,e){return{cellno:e,cellno_cc:t+""+e,cellno_e164:"+"+t+e}},ir=function t(e){if("object"!==Kn(e))return{};if(nt(e).length>100)return{};var n={};for(var r in e)if(e.hasOwnProperty(r)){var i=r;"string"!==Kn(i)&&(i=String(i));var o=e[i];if("object"===Kn(o))o=t(o);else if("string"!==Kn(o)||Wn(o))continue;n[i]=o}return n},or=function(t){if("object"!==Kn(t))return{};if(nt(t).length>100)return{};var e={};for(var n in t)if(t.hasOwnProperty(n)){var r=n;"string"!==Kn(r)&&(r=String(r));var i=ar(t[r]);null!==i&&(e[r]=i)}return e},ar=function(t){var e=t;return-1===["object","string","boolean","number"].indexOf(Kn(e))?null:"object"===Kn(e)?or(t):t},sr=function(t){if("object"!==Kn(t))return{};if(nt(t).length>100)return{};var e={};for(var n in t)if(t.hasOwnProperty(n)){var r=n;"string"!==Kn(r)&&(r=String(r));var i=ur(t[r]);null!==i&&(e[r]=i)}return e},cr=["nan","function","arguments","regexp","element","error"],ur=function t(e){var n=Kn(e);if(-1!==cr.indexOf(n))e=null;else if("undefined"===n)e=null;else if("array"===n){for(var r=[],i=0;i<e.length;i++){var o=e[i],a=Kn(o);"array"!==a&&("object"===a?r.push(sr(o)):r.push(t(o)))}e=r}else"object"===n&&(e=sr(e));return e},lr=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{hashfn:"all"},n={},r=new Hn(t);return"all"===e.hashfn?e.includeLC&&e.includeUC?(n.sha256_lowercase=r.sha256l(),n.sha256_uppercase=r.sha256u(),n.sha1_lowercase=r.sha1l(),n.sha1_uppercase=r.sha1u(),n.md5_lowercase=r.md5l(),n.md5_uppercase=r.md5u()):(n.sha256=r.sha256(),n.sha1=r.sha1(),n.md5=r.md5()):"sha256"===e.hashfn?n.sha256=r.sha256():"sha1"===e.hashfn?n.sha1=r.sha1():"md5"===e.hashfn&&(n.md5=r.md5()),n},fr=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if("array"===Kn(e)||"object"===Kn(t)){var n={};for(var r in t)-1===e.indexOf(r)&&(n[r]=t[r]);return n}},hr=function(t){return t.includes(" ")},dr={log:qn,isNullOrEmpty:Vn,isEmptyString:Wn,getTimeStamp:function(){return(new Date).getTime()},cleanCellNumber:Jn,getUUIDv4:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))},readFromStorage:Xn,writeToStorage:function(t,e){tr()?window.localStorage.setItem(t,e):$n(t,e)},clearFromStorage:function(t){Vn(Xn(t))||(tr()?window.localStorage.removeItem(t):Yn(t))},getSessionVal:function(t){return er()?window.sessionStorage.getItem(t):Qn(t)},setSessionVal:function(t,e){if(!er())return $n(t,e,0,!0);window.sessionStorage.setItem(t,e)},clearSessionVal:function(t){if(!er())return Yn(t,value);window.sessionStorage.removeItem(t)},hasGdprConsent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.reduce((function(e,n){return e&&t[n]}),!0)},onlyCallOnceCallback:function(t){var e=!1;return function(){if(!e)return e=!0,t.apply(this,arguments)}},getType:Kn,validateIdentitiesObject:ir,validateStorageObject:or,validateProperties:sr,hash:lr,hashIdentities:function(t){var e=ir(t),n={};if("object"!==Kn(e))return{};if("string"===Kn(e.email)&&e.email&&(n.email=lr(e.email,{hashfn:"all",removeOriginal:!0,includeLC:!0,includeUC:!0})),"string"===Kn(e.loginid)&&e.loginid&&(n.loginid=lr(e.loginid,{hashfn:"all",removeOriginal:!0,includeLC:!0,includeUC:!0})),"string"===Kn(e.fpuid)&&e.fpuid&&(n.fpuid=e.fpuid),"string"===Kn(e.cellno)&&e.cellno){var r=Jn(e.cellno);n.cellno=lr("".concat(r),{hashfn:"all",removeOriginal:!0})}if("string"===Kn(e.cellno_cc)&&e.cellno_cc){var i=Jn(e.cellno_cc);n.cellno_cc=lr("".concat(i),{hashfn:"all",removeOriginal:!0})}"string"===Kn(e.cellno_e164)&&e.cellno_e164&&(n.cellno_e164=lr(e.cellno_e164,{hashfn:"all",removeOriginal:!0}));var o=nt(e).reduce((function(t,n){return Le.indexOf(n)<0&&(t[n]=e[n]),t}),{});return me(me({},n),o)},removePropertiesfromObject:fr,transformIdentitiesToUserProperties:function(t){if(Vn(t)||"object"!==Kn(t))return qn("Invalid Identities object found returning empty object instead"),{};var e=me({},t);return e.cellno&&(e.cellno_without_country_code=e.cellno,e=fr(e,["cellno"])),e.cellno_cc&&(e.cellno_with_country_code=e.cellno_cc,e=fr(e,["cellno_cc"])),e},base64:{encode:function(t){return encodeURIComponent(btoa(t))},decode:function(t){return atob(decodeURIComponent(t))}},getLocation:function(){return window&&window.location?window.location:{pathname:"",href:""}},getReferrer:function(){return document.referrer},getQueryParamMap:function(t){return Te.parse(t)},flattenObject:function t(e){var n={};for(var r in e)if(e.hasOwnProperty(r))if("object"==Cn(e[r])&&null!==e[r]){var i=t(e[r]);for(var o in i)i.hasOwnProperty(o)&&(n[r+"."+o]=i[o])}else n[r]=e[r];return n},validateRawIdentities:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("object"!==Cn(t))return{};if(e){if(t.cellno&&"string"==typeof t.cellno&&""!==t.cellno&&hr(t.cellno.trim())){t=fr(t,["cellno_cc"]);var n=Jn(t.cellno).trim(),r=n.split(" ");t=me(me({},t),rr(r[0],r[1]))}}else t.cellno&&hr(t.cellno.trim())?(t.cellno_cc=t.cellno,t=fr(t,["cellno"])):t.cellno_cc&&hr(t.cellno_cc.trim())||t.cellno_cc&&t.cellno?t=fr(t,["cellno"]):t.cellno&&(t.cellno_cc=t.cellno,t=fr(t,["cellno"]));return nt(t).reduce((function(e,n){return me(me({},e),nr(n,t[n]))}),{})},validateHashedIdentities:function(t){if("object"!==Cn(t))return{};var e={};return nt(t).forEach((function(n){var r=Ue[n];r&&"string"==typeof t[n]&&""!==t[n]?e[r.id]?e[r.id][r.type]=t[n]:"fpuid"===r.id?e[r.id]=t[n]:e[r.id]=ye({},r.type,t[n]):Le.indexOf(n)>=0?console.warn("Invalid identity [".concat(n,"] set. Identity attribute should belong to: [ ").concat(nt(Ue)," ]")):"string"==typeof t[n]&&""!==t[n]&&(e[n]=t[n])})),e},getCustomIdentities:function(t){return nt(t).reduce((function(e,n){return Le.indexOf(n)<0&&Fe.indexOf(n)<0&&nt(Ue).indexOf(n)<0&&(e["user_"+n]=t[n]),e}),{})},domainSpecific:function(t,e){var n="";return!e.ignoreSuffix&&e.domain&&(n="."===e.domain.charAt(0)?e.domain.substring(1):e.domain),t+n},hash256:function(t){return new Hn(t).sha256()},getIdentitesSPLEventName:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(var r in e){if(!t[r])return ze;if(t[r])if(Le.indexOf(r)>=0){if(n){var i=t[r].sha256?"sha256":"sha256_lowercase";if(t[r][i]!==e[r][i])return Ne}else if(t[r]!==e[r])return Ne}else if(t[r]!==e[r])return Ne}return null},sanitizeEmail:function(t){var e=t.split("@"),n=Pn(e,2),r=n[0],i=n[1];return r=r.replace(/[+.]/g,""),"".concat(r,"@").concat(i)},isObjectEmpty:function(t){return"object"===Cn(t)&&0===nt(t).length}},pr=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new On;_e(this,t),this._options=me({},Pe),this.onOptionsChangeEvent=e}return Se(t,[{key:"apiKey",get:function(){this._options.apiKey},set:function(t){this._options.apiKey=t}},{key:"options",get:function(){return this._options},set:function(t){this._options=me(me({},this._options),t)}},{key:"persistentStorageKeySuffix",get:function(){return"_"+dr.base64.encode(this._options.apiKey)}},{key:"domain",set:function(t){this._options.domain=t}},{key:"validateOptions",value:function(t){t.areIdentitiesHashed&&t.hashIdentities&&console.error("Cannot transform hashed identities.")}},{key:"setOptions",value:function(t){this.validateOptions(t),"object"===Cn(t)&&(this._options=me(me({},this._options),t||{}),this.onOptionsChangeEvent.dispatchEvent(new Event("optionsChange",this._options)))}},{key:"getStorageOptions",value:function(){return{expirationDays:this._options.storageExpirationDays,domain:this._options.domain,secure:this._options.onlySecureCookie,persistenceInCookieStorage:this._options.persistenceInCookieStorage}}},{key:"listenToOptionsChange",value:function(t){t(new Event("optionsChange",this._options)),this.onOptionsChangeEvent.addEventListener("optionsChange",t)}},{key:"removeOptionsChangeListener",value:function(t){this.onOptionsChangeEvent.removeEventListener("optionsChange",t)}}]),t}(),vr=["trace","debug","info","warn","error"],gr=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L;_e(this,t),this.log=e}return Se(t,[{key:"updateLogger",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=window.location.search,r=/[?&]zeo_debug=([^&]*)/,i=n.match(r),o=!1;i&&void 0!==i[1]&&(o=i[1]),t||o?(this.log.enableAll(),vr.find((function(t){return t===e}))?this.log.setLevel(e):this.log.setLevel("info")):this.log.disableAll()}},{key:"setLoggerStatus",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"debug";t?(this.log.enableAll(),vr.find((function(t){return t===e}))?this.log.setLevel(e):this.log.setLevel("warn")):this.log.disableAll()}},{key:"logInfo",value:function(t,e){for(var n,r="%c[".concat(t,"]:: ").concat(e),i="color: green; font-weight: bold",o=arguments.length,a=new Array(o>2?o-2:0),s=2;s<o;s++)a[s-2]=arguments[s];(n=this.log).info.apply(n,[r,i].concat(a))}},{key:"logWarning",value:function(t,e){for(var n,r="%c[".concat(t,"]:: ").concat(e),i="color: red; font-weight: bold",o=arguments.length,a=new Array(o>2?o-2:0),s=2;s<o;s++)a[s-2]=arguments[s];(n=this.log).warn.apply(n,[r,i].concat(a))}},{key:"logError",value:function(t,e){for(var n,r="%c[".concat(t,"]:: ").concat(e),i="color: pruple; font-weight: bold",o=arguments.length,a=new Array(o>2?o-2:0),s=2;s<o;s++)a[s-2]=arguments[s];(n=this.log).error.apply(n,[r,i].concat(a))}}]),t}(),yr=function(){function t(e,n,r){var i=this;_e(this,t),this.cookie=n,this.localStorage=r,this.optionsService=e,this.tld=this.cookie.getTld(),this.optionsService.listenToOptionsChange((function(){var t=i.optionsService.getStorageOptions();i.options=t,i.options.domain=i.cookie.getValidDomain(t)}))}return Se(t,[{key:"isCookieEnabledInOptions",get:function(){return this.optionsService._options.persistenceInCookieStorage}},{key:"isCookieEnabled",value:function(){if(void 0!==this.isCookieEnabledValue)return this.isCookieEnabledValue;var t,e=String(new Date);try{return this.cookie.set("ztestc",e,{domain:this.tld}),t=this.cookie.get("ztestc",{domain:this.tld})===e,this.cookie.remove("ztestc",{domain:this.tld}),this.isCookieEnabledValue=t,t}catch(t){this.isCookieEnabledValue=!1}return this.isCookieEnabledValue=!1,!1}},{key:"getStorage",value:function(t){return t?this.localStorage:this.isCookieEnabled()?this.cookie:this.localStorage}},{key:"set",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=me(me({},this.options),n);this.getStorage(r).set(t,e,me(me({},i),{},{domain:i.domain?i.domain:this.tld}))}},{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=me(me({},this.options),e);return this.getStorage(n).get(t,me(me({},r),{},{domain:r.domain?r.domain:this.tld}))}},{key:"remove",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=me(me({},this.options),e);return this.getStorage(n).remove(t,me(me({},r),{},{domain:r.domain?r.domain:this.tld}))}},{key:"setSessionStorage",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e){var r,i,o=me({},this.options),a=dr.domainSpecific(t,me(me({},o),{},{domain:o.domain?o.domain:this.tld}));if(n.hash)r=n.isString?dr.hash256(e):dr.hash256(be(e)),sessionStorage.setItem(a,dr.base64.encode(r));else i=n.isString?e:be(e),sessionStorage.setItem(a,dr.base64.encode(i))}}},{key:"getSessionStorage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=me({},this.options),r=dr.domainSpecific(t,me(me({},n),{},{domain:n.domain?n.domain:this.tld})),i=sessionStorage.getItem(r);try{if(i)return e.isString||e.hash?dr.base64.decode(i):JSON.parse(dr.base64.decode(i))}catch(t){return null}}},{key:"removeSessionStorage",value:function(t){var e=me({},this.options),n=dr.domainSpecific(t,me(me({},e),{},{domain:e.domain?e.domain:this.tld}));sessionStorage.removeItem(n)}},{key:"getFromCookieOrSession",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=me(me({},this.options),e);return this.isCookieEnabledInOptions&&this.isCookieEnabled()?this.cookie.get(t,me(me({},n),{},{domain:n.domain?n.domain:this.tld})):this.getSessionStorage(t,e)}},{key:"setInCookieOrSession",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=me(me({},this.options),n);this.isCookieEnabledInOptions&&this.isCookieEnabled()?this.cookie.set(t,e,me(me({},r),{},{domain:r.domain?r.domain:this.tld})):this.setSessionStorage(t,e,n)}},{key:"removeFromCookieOrSession",value:function(t,e){var n=me(me({},this.options),e);this.isCookieEnabledInOptions&&this.isCookieEnabled()?this.cookie.remove(t,me(me({},n),{},{domain:n.domain?n.domain:this.tld})):this.removeSessionStorage(t)}}]),t}(),mr="\t\n\v\f\r Â áá ââââââââââââ¯âã\u2028\u2029\ufeff",_r="["+mr+"]",Sr=RegExp("^"+_r+_r+"*"),wr=RegExp(_r+_r+"*$"),br=function(t,e,n){var r={},i=u((function(){return!!mr[t]()||"âÂ"!="âÂ"[t]()})),o=r[t]=i?e(Ir):mr[t];n&&(r[n]=o),I(I.P+I.F*i,"String",r)},Ir=br.trim=function(t,e){return t=String(F(t)),1&e&&(t=t.replace(Sr,"")),2&e&&(t=t.replace(wr,"")),t},xr=br,kr=r.parseInt,Or=xr.trim,Cr=/^[-+]?0[xX]/,Er=8!==kr(mr+"08")||22!==kr(mr+"0x16")?function(t,e){var n=Or(String(t),3);return kr(n,e>>>0||(Cr.test(n)?16:10))}:kr;I(I.S+I.F*(Number.parseInt!=Er),"Number",{parseInt:Er});i.Number.parseInt;I(I.G+I.F*(parseInt!=Er),{parseInt:Er});var jr=i.parseInt,Tr={expirationDays:void 0,domain:void 0,ignoreSuffix:!1};var Ar,Dr,Pr,Lr,Fr,Ur,zr,Nr,Rr=function(t,e){var n=function(){this._options=me({},Tr)},r=function(t){return{getCookie:function(e){try{for(var n=t.cookie.split(";"),r=null,i=0;i<n.length;i++){for(var o=n[i];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(e)){r=o.substring(e.length,o.length);break}}return r}catch(t){return null}},setCookie:function(e,n,r){var i=null!==n?r.expirationDateTime:-1;if(i){var o=new Date;o.setTime(i),i=o}var a=e+"="+n;i&&(a+="; expires="+i.toUTCString()),a+="; path=/",r.domain&&(a+="; domain="+r.domain),r.secure&&(a+="; Secure"),a+="; samesite=".concat(r.sameSite),t.cookie=a}}}(e),i=function(){return t.location};n.prototype.reset=function(){this._options=me({},Tr)};var o=function(t){var n=function(t){var n=e.createElement("a");return n.href=t,n.hostname||i().hostname}(t).split("."),o=n[n.length-1],a=[];if(4===n.length&&o===jr(o,10))return a;if(n.length<=1)return a;for(var s=n.length-2;s>=0;--s)a.push(n.slice(s).join("."));for(var c=0;c<a.length;++c){var u="__tld_test__",l=a[c],f={domain:"."+l};if(r.setCookie(u,1,f),r.getCookie(u))return r.setCookie(u,null,f),l}return""};n.prototype.getTld=function(){return"."+o(i().href)},n.prototype.getValidDomain=function(t){var e=dr.isEmptyString(t.domain)?this.getTld():t.domain;t.domain=e;var n=Math.random();this.set("ztestc",n,t);var r=this.get("ztestc",t);return r&&r===n||(e=null),this.remove("ztestc",t),e},n.prototype.options=function(t){return 0===arguments.length||(t=t||{},this._options.expirationDays=t.expirationDays,this._options.secure=t.secure,this._options.ignoreSuffix=!!t.ignoreSuffix&&t.ignoreSuffix,this._options.domain=t.domain,this._options.domain=this.getValidDomain(this._options)),this._options};var a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tr,n="";return!e.ignoreSuffix&&e.domain&&(n="."===e.domain.charAt(0)?e.domain.substring(1):e.domain),t+n};return n.prototype.get=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=me(me({},this._options),e),i=r.getCookie(a(t,n)+"=");try{if(i)return!1!==e.encrypted?JSON.parse(dr.base64.decode(i)):i}catch(t){return null}return null},n.prototype.set=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=me(me({},this._options),n);i.expirationDateTime=i.expirationDateTime?i.expirationDateTime:i.expirationDays?(new Date).getTime()+24*i.expirationDays*60*60*1e3:void 0;try{return r.setCookie(a(t,i),dr.base64.encode(be(e)),i),!0}catch(t){return!1}},n.prototype.remove=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=me(me({},this._options),e);try{return r.setCookie(a(t,n),null,n),!0}catch(t){return!1}},n}(window,document),Mr=(Ar=window,Pr=(Dr=Ar).localStorage?Dr.localStorage:{length:0,setItem:function(t,e){},getItem:function(t){},removeItem:function(t){},clear:function(){},key:function(t){}},Lr="base64",Fr=function(){return"base64"===Lr},{setEncoding:function(t){Lr=t},options:function(t){return t},get:function(t){try{var e=Pr.getItem(t);return e?Fr()?JSON.parse(dr.base64.decode(e)):JSON.parse(e):null}catch(e){console.error("Error occured in getting from local storage",t,e)}return null},set:function(t,e){try{return Fr()?Pr.setItem(t,dr.base64.encode(be(e))):Pr.setItem(t,be(e)),!0}catch(n){console.error("Error occured in setting to local storage",t,e,n)}return!1},remove:function(t){try{Pr.removeItem(t)}catch(t){return!1}}}),Br=function(){function t(){_e(this,t),this.onIdentitiesChangeEventTarget=document,this.previousValue=null}return Se(t,[{key:"trigger",value:function(t){(!this.previousValue||be(this.previousValue)!==be(t))&&(this.previousValue=t,this.onIdentitiesChangeEventTarget.dispatchEvent(new CustomEvent("onIdentitiesChange",{detail:t})))}},{key:"listen",value:function(t){this.onIdentitiesChangeEventTarget.addEventListener("onIdentitiesChange",t)}},{key:"reset",value:function(){this.previousValue=null}},{key:"removeListener",value:function(t){this.onIdentitiesChangeEventTarget.removeEventListener("onIdentitiesChange",t)}}]),t}(),Gr={ignoreSuffix:!0,domain:null,encrypted:!1},Zr=function(t){return"zpstorage_"+dr.base64.encode(t)+"zi"},Hr=function(t){return"zpstorage_"+dr.base64.encode(t)+"identity"},qr=function(t){return"zpstorage_"+dr.base64.encode(t)+"zs"},Kr=function(){function t(e,n,r){_e(this,t),this.optionsService=e,this.storageService=n,this.logger=r,this._zi=null,this._zs=null,this._identity={},this._gaClientId=null,this._gaUserId=null,this._identityEvents=new Br}return Se(t,[{key:"getOrGenerateZI",value:function(){return"string"!==dr.getType(this._zi)||dr.isNullOrEmpty(this._zi)?dr.getUUIDv4():(this.logger.logInfo("getOrGenerateZI","ZI cookie value: ",this._zi),this._zi)}},{key:"setZI",value:function(t){this.logger.logInfo("setZI","ZI cookie being set as: ",t),this._zi=t,this.saveZItoStorage()}},{key:"resetZI",value:function(){this._zi=dr.getUUIDv4(),this.logger.logInfo("resetZI","ZI cookie being reset as: ",this._zi),this.saveZItoStorage()}},{key:"getOrGenerateZS",value:function(){return("string"!==dr.getType(this._zs)||dr.isNullOrEmpty(this._zs))&&(this._zs=dr.getUUIDv4()),this._zs}},{key:"getGAClientIdFromStorage",value:function(){if(this.optionsService.options.allowGAClientId){var t=this.storageService.get(this.optionsService.options.gaClientIdCookiePrefix?this.optionsService.options.gaClientIdCookiePrefix+"_ga":"_ga",Gr);return t&&(t=t.split(".").splice(2).join(".")),this.logger.logInfo("getGAClientIdFromStorage","Google Analytics Client ID: ",t),t}return null}},{key:"setGAUserIdFromStorage",value:function(){var t;this.optionsService.options.gaUserIdCookieName&&(t=this.storageService.get(this.optionsService.options.gaUserIdCookieName,Gr),this.logger.logInfo("setGAUserIdFromStorage","Google Analytics User ID: ",t)),this._gaUserId=t}},{key:"resetZS",value:function(){this._zs=dr.getUUIDv4(),this.logger.logInfo("resetZS","Setting ZS as: ",this._zs),this.saveZStoStorage()}},{key:"resetZsExpiry",value:function(){this.loadAndPersistZS(),this.getOrGenerateZS(),this.saveZStoStorage()}},{key:"loadZIfromStorage",value:function(){var t=this.storageService.get(Zr(this.optionsService.options.apiKey));this._zi=dr.isEmptyString(t)?null:t,this.saveZItoStorage()}},{key:"saveZItoStorage",value:function(){dr.isEmptyString(this._zi)||(this.logger.logInfo("saveZItoStorage","Saving ZI to storage: ",this._zi),this.storageService.set(Zr(this.optionsService.options.apiKey),this._zi,{expirationDays:365}),this._identityEvents.trigger(this.getAllIdentites()))}},{key:"getUserIdentitesFromStorage",value:function(){var t=this.storageService.getFromCookieOrSession(Hr(this.optionsService.options.apiKey),{isString:!1,hash:!1});this._identity=me({},t),this.logger.logInfo("getUserIdentityFromStorage","User Identity: ",this._identity)}},{key:"saveUserIdentityToStorage",value:function(){var t=Hr(this.optionsService.options.apiKey);this.logger.logInfo("saveUserIdentityToStorage","Saving User Identity to sesion storage with name as: ",t);var e=this.storageService.get(t);e&&(this._identity=me(me({},this._identity),e),this.storageService.removeFromCookieOrSession(t)),this.storageService.setInCookieOrSession(t,this._identity,{hash:!1,isString:!1}),this._identityEvents.trigger(this.getAllIdentites())}},{key:"getZSFromStorage",value:function(){var t=this.storageService.getFromCookieOrSession(qr(this.optionsService.options.apiKey),{isString:!0});this._zs=dr.isEmptyString(t)?dr.getUUIDv4():t}},{key:"loadAndPersistZS",value:function(){this.getZSFromStorage(),this.saveZStoStorage()}},{key:"saveZStoStorage",value:function(){dr.isEmptyString(this._zs)||(this.logger.logInfo("saveZStoStorage","Saving ZS to storage: ",this._zs),this.storageService.removeFromCookieOrSession(qr(this.optionsService.options.apiKey)),this.storageService.setInCookieOrSession(qr(this.optionsService.options.apiKey),this._zs,{isString:!0,hash:!1}),this._identityEvents.trigger(this.getAllIdentites()))}},{key:"getIdentity",value:function(){return this._identity}},{key:"setIdentity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._identity=me(me({},this._identity),t),this.logger.logInfo("setIdentity","Set identity as: ",this._identity),this.saveUserIdentityToStorage()}},{key:"unsetIdentity",value:function(){if(this.logger.logInfo("unsetIdentity","Unsetting identity"),0===arguments.length)return this._identity={},void this.saveUserIdentityToStorage();var t=arguments[0];return"array"===dr.getType(t)?(this._identity=dr.removePropertiesfromObject(this._identity,t),void this.saveUserIdentityToStorage()):void 0}},{key:"resolveAll",value:function(){this.logger.logInfo("resolveAll","Resolve all identifiers."),this._zi=this.getOrGenerateZI(),this._zs=this.getOrGenerateZS(),this._gaClientId=this.getGAClientIdFromStorage(),this.saveZItoStorage(),this.saveUserIdentityToStorage(),this.saveZStoStorage(),this.optionsService.options.gaUserIdOnlyLoginEvent||this.setGAUserIdFromStorage()}},{key:"resolveAndGetZI",value:function(){return this._zi=this.getOrGenerateZI(),this.saveZItoStorage(),this._zi}},{key:"resolveAndGetZS",value:function(){return this._zs=this.getOrGenerateZS(),this.saveZStoStorage(),this._zs}},{key:"resolveAndGetGAClientID",value:function(){return this._gaClientId=this.getGAClientIdFromStorage(),this._gaClientId}},{key:"resolveAndgetGAUserIdFromStorage",value:function(){return this.optionsService.options.gaUserIdOnlyLoginEvent||this.setGAUserIdFromStorage(),this._gaUserId}},{key:"clearAll",value:function(){this.logger.logInfo("clearAll","Clear all identifiers."),this._identity={},this._gaClientId=null,this._gaUserId=null,this.storageService.removeFromCookieOrSession(Hr(this.optionsService.options.apiKey))}},{key:"loadFromStorage",value:function(){this.loadZIfromStorage(),this.getUserIdentitesFromStorage(),this.getZSFromStorage(),this._gaClientId=this.getGAClientIdFromStorage(),this.optionsService.options.gaUserIdOnlyLoginEvent||this.setGAUserIdFromStorage()}},{key:"events",get:function(){return this._identityEvents}},{key:"getAllIdentites",value:function(){return me({user_zi:this._zi},this._identity)}},{key:"stampAllUserIdentitiesInStorage",value:function(){this.resolveAndGetZI(),this.saveUserIdentityToStorage(),this.saveZStoStorage()}}]),t}(),Vr=n((function(t){var e={},n={},r=t.exports=function(t,r,i,o,s){var u,l,f,h,d=s?function(){return t}:hn(t),p=a(i,o,r?2:1),v=0;if("function"!=typeof d)throw TypeError(t+" is not iterable!");if(yn(d)){for(u=q(t.length);u>v;v++)if((h=r?p(c(l=t[v])[0],l[1]):p(t[v]))===e||h===n)return h}else for(f=d.call(t);!(l=f.next()).done;)if((h=pn(f,p,l.value,r))===e||h===n)return h};r.BREAK=e,r.RETURN=n})),Wr=it("species"),Jr=function(t,e){var n,r=c(t).constructor;return void 0===r||null==(n=c(r)[Wr])?e:o(n)},$r=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)},Qr=r.process,Yr=r.setImmediate,Xr=r.clearImmediate,ti=r.MessageChannel,ei=r.Dispatch,ni=0,ri={},ii=function(){var t=+this;if(ri.hasOwnProperty(t)){var e=ri[t];delete ri[t],e()}},oi=function(t){ii.call(t.data)};Yr&&Xr||(Yr=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return ri[++ni]=function(){$r("function"==typeof t?t:Function(t),e)},Ur(ni),ni},Xr=function(t){delete ri[t]},"process"==N(Qr)?Ur=function(t){Qr.nextTick(a(ii,t,1))}:ei&&ei.now?Ur=function(t){ei.now(a(ii,t,1))}:ti?(Nr=(zr=new ti).port2,zr.port1.onmessage=oi,Ur=a(Nr.postMessage,Nr,1)):r.addEventListener&&"function"==typeof postMessage&&!r.importScripts?(Ur=function(t){r.postMessage(t+"","*")},r.addEventListener("message",oi,!1)):Ur="onreadystatechange"in d("script")?function(t){gt.appendChild(d("script")).onreadystatechange=function(){gt.removeChild(this),ii.call(t)}}:function(t){setTimeout(a(ii,t,1),0)});var ai={set:Yr,clear:Xr},si=ai.set,ci=r.MutationObserver||r.WebKitMutationObserver,ui=r.process,li=r.Promise,fi="process"==N(ui);function hi(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r})),this.resolve=o(e),this.reject=o(n)}var di,pi,vi,gi,yi,mi,_i={f:function(t){return new hi(t)}},Si=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}},wi=r.navigator,bi=wi&&wi.userAgent||"",Ii=function(t,e){if(c(t),s(e)&&e.constructor===t)return e;var n=_i.f(t);return(0,n.resolve)(e),n.promise},xi=it("species"),ki=ai.set,Oi=function(){var t,e,n,i=function(){var r,i;for(fi&&(r=ui.domain)&&r.exit();t;){i=t.fn,t=t.next;try{i()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(fi)n=function(){ui.nextTick(i)};else if(!ci||r.navigator&&r.navigator.standalone)if(li&&li.resolve){var o=li.resolve(void 0);n=function(){o.then(i)}}else n=function(){si.call(r,i)};else{var a=!0,s=document.createTextNode("");new ci(i).observe(s,{characterData:!0}),n=function(){s.data=a=!a}}return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}(),Ci=r.TypeError,Ei=r.process,ji=Ei&&Ei.versions,Ti=ji&&ji.v8||"",Ai=r.Promise,Di="process"==ln(Ei),Pi=function(){},Li=pi=_i.f,Fi=!!function(){try{var t=Ai.resolve(1),e=(t.constructor={})[it("species")]=function(t){t(Pi,Pi)};return(Di||"function"==typeof PromiseRejectionEvent)&&t.then(Pi)instanceof e&&0!==Ti.indexOf("6.6")&&-1===bi.indexOf("Chrome/66")}catch(t){}}(),Ui=function(t){var e;return!(!s(t)||"function"!=typeof(e=t.then))&&e},zi=function(t,e){if(!t._n){t._n=!0;var n=t._c;Oi((function(){for(var r=t._v,i=1==t._s,o=0,a=function(e){var n,o,a,s=i?e.ok:e.fail,c=e.resolve,u=e.reject,l=e.domain;try{s?(i||(2==t._h&&Mi(t),t._h=1),!0===s?n=r:(l&&l.enter(),n=s(r),l&&(l.exit(),a=!0)),n===e.promise?u(Ci("Promise-chain cycle")):(o=Ui(n))?o.call(n,c,u):c(n)):u(r)}catch(t){l&&!a&&l.exit(),u(t)}};n.length>o;)a(n[o++]);t._c=[],t._n=!1,e&&!t._h&&Ni(t)}))}},Ni=function(t){ki.call(r,(function(){var e,n,i,o=t._v,a=Ri(t);if(a&&(e=Si((function(){Di?Ei.emit("unhandledRejection",o,t):(n=r.onunhandledrejection)?n({promise:t,reason:o}):(i=r.console)&&i.error&&i.error("Unhandled promise rejection",o)})),t._h=Di||Ri(t)?2:1),t._a=void 0,a&&e.e)throw e.v}))},Ri=function(t){return 1!==t._h&&0===(t._a||t._c).length},Mi=function(t){ki.call(r,(function(){var e;Di?Ei.emit("rejectionHandled",t):(e=r.onrejectionhandled)&&e({promise:t,reason:t._v})}))},Bi=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),zi(e,!0))},Gi=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw Ci("Promise can't be resolved itself");(e=Ui(t))?Oi((function(){var r={_w:n,_d:!1};try{e.call(t,a(Gi,r,1),a(Bi,r,1))}catch(t){Bi.call(r,t)}})):(n._v=t,n._s=1,zi(n,!1))}catch(t){Bi.call({_w:n,_d:!1},t)}}};Fi||(Ai=function(t){!function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!")}(this,Ai,"Promise","_h"),o(t),di.call(this);try{t(a(Gi,this,1),a(Bi,this,1))}catch(t){Bi.call(this,t)}},(di=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(t,e,n){for(var r in e)n&&t[r]?t[r]=e[r]:_(t,r,e[r]);return t}(Ai.prototype,{then:function(t,e){var n=Li(Jr(this,Ai));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=Di?Ei.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&zi(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),vi=function(){var t=new di;this.promise=t,this.resolve=a(Gi,t,1),this.reject=a(Bi,t,1)},_i.f=Li=function(t){return t===Ai||t===gi?new vi(t):pi(t)}),I(I.G+I.W+I.F*!Fi,{Promise:Ai}),st(Ai,"Promise"),mi="function"==typeof i[yi="Promise"]?i[yi]:r[yi],l&&mi&&!mi[xi]&&y.f(mi,xi,{configurable:!0,get:function(){return this}}),gi=i.Promise,I(I.S+I.F*!Fi,"Promise",{reject:function(t){var e=Li(this);return(0,e.reject)(t),e.promise}}),I(I.S+!0*I.F,"Promise",{resolve:function(t){return Ii(this===gi?Ai:this,t)}}),I(I.S+I.F*!(Fi&&wn((function(t){Ai.all(t).catch(Pi)}))),"Promise",{all:function(t){var e=this,n=Li(e),r=n.resolve,i=n.reject,o=Si((function(){var n=[],o=0,a=1;Vr(t,!1,(function(t){var s=o++,c=!1;n.push(void 0),a++,e.resolve(t).then((function(t){c||(c=!0,n[s]=t,--a||r(n))}),i)})),--a||r(n)}));return o.e&&i(o.v),n.promise},race:function(t){var e=this,n=Li(e),r=n.reject,i=Si((function(){Vr(t,!1,(function(t){e.resolve(t).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}}),I(I.P+I.R,"Promise",{finally:function(t){var e=Jr(this,i.Promise||r.Promise),n="function"==typeof t;return this.then(n?function(n){return Ii(e,t()).then((function(){return n}))}:t,n?function(n){return Ii(e,t()).then((function(){throw n}))}:t)}}),I(I.S,"Promise",{try:function(t){var e=_i.f(this),n=Si(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}});var Zi=i.Promise,Hi=e(n((function(t){function e(t,e,n,r,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Zi.resolve(c).then(r,i)}t.exports=function(t){return function(){var n=this,r=arguments;return new Zi((function(i,o){var a=t.apply(n,r);function s(t){e(a,i,o,s,c,"next",t)}function c(t){e(a,i,o,s,c,"throw",t)}s(void 0)}))}},t.exports.default=t.exports,t.exports.__esModule=!0}))),qi=n((function(t){var e=function(t){var e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var i=e&&e.prototype instanceof f?e:f,o=Object.create(i.prototype),a=new I(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return k()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(t,n,a),o}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var l={};function f(){}function h(){}function d(){}var p={};p[i]=function(){return this};var v=Object.getPrototypeOf,g=v&&v(v(x([])));g&&g!==e&&n.call(g,i)&&(p=g);var y=d.prototype=f.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){var r;this._invoke=function(i,o){function a(){return new e((function(r,a){!function r(i,o,a,s){var c=u(t[i],t,o);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function S(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function w(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function b(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(w,this),this.reset(!0)}function x(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:k}}function k(){return{value:void 0,done:!0}}return h.prototype=y.constructor=d,d.constructor=h,h.displayName=s(d,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},m(_.prototype),_.prototype[o]=function(){return this},t.AsyncIterator=_,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new _(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(y),s(y,a,"Generator"),y[i]=function(){return this},y.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=x,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),b(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;b(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:x(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}})),Ki=function(){function t(){_e(this,t),this.pageProperties={}}return Se(t,[{key:"getPageProperties",value:function(){var t=dr.getLocation(),e=this.pageProperties[t.pathname]?this.pageProperties[t.pathname]:{};return me({page_path:t.pathname,page_referrer:dr.getReferrer()},e)}},{key:"setPageProperties",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=dr.getLocation().pathname,n=dr.validateProperties(t);dr.isEmptyString(e)||(this.pageProperties[e]=n)}}]),t}(),Vi=function(){function t(e,n,r){_e(this,t),this.requestService=r,this.optionsService=e}return Se(t,[{key:"callInteractionPixel",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pixel",n=t[e];n&&this.requestService.get(n,{},(function(t,e){}),{basicAuthKey:btoa("w_k:"+this.optionsService.options.apiKey)})}}]),t}(),Wi=Object.assign,Ji=!Wi||u((function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach((function(t){e[t]=t})),7!=Wi({},t)[n]||Object.keys(Wi({},e)).join("")!=r}))?function(t,e){for(var n=U(t),r=arguments.length,i=1,o=ft.f,a=ht.f;r>i;)for(var s,c=R(arguments[i++]),u=o?et(c).concat(o(c)):et(c),f=u.length,h=0;f>h;)s=u[h++],l&&!a.call(c,s)||(n[s]=c[s]);return n}:Wi;I(I.S+I.F,"Object",{assign:Ji});var $i=i.Object.assign,Qi=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"_";return nt(e).reduce((function(i,o){var a=n.length?n+r:"";return"object"!==Cn(e[o])||null===e[o]||sn(e[o])?i[a+o]=e[o]:$i(i,t(e[o],a+o)),i}),{})},Yi=["sticky-banner","fullscreen-overlay"],Xi=["sticky-banner","fullscreen-overlay"],to=function(){function t(e,n){_e(this,t),this.document=e.document,this.interactionLoggingService=n}return Se(t,[{key:"logInteractionDismissed",value:function(t){this.interactionLoggingService.callInteractionPixel(t,"onDismiss")}},{key:"logInteractionClicked",value:function(t){this.interactionLoggingService.callInteractionPixel(t,"onClick")}},{key:"applyStyleToElement",value:function(t,e){nt(e).forEach((function(n){t.style[n]=e[n]}))}},{key:"createDiv",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"interactDiv",n=this.document.createElement("div");return n.classList.add(e),this.applyStyleToElement(n,t),n}},{key:"appendDivToBody",value:function(t){this.document.body.appendChild(t)}},{key:"setDisplayProperty",value:function(t,e){t.style.display=e}},{key:"hideDiv",value:function(t){this.setDisplayProperty(t,"none")}},{key:"removeDiv",value:function(t){t.remove()}},{key:"addCloseButtonToDivTopRight",value:function(t,e){var n=this.document.createElement("button");e.style.display="relative",n.textContent="X";this.applyStyleToElement(n,{background:"transparent",border:"unset",cursor:"pointer",position:"absolute",top:"0",right:"0"}),n.addEventListener("click",function(){this.logInteractionDismissed(t),this.removeDiv(e)}.bind(this)),e.appendChild(n)}},{key:"applyClickOutsideToClose",value:function(t,e){var n=this.document.addEventListener("click",function(r){e.contains(r.target)||(this.logInteractionDismissed(t),this.removeDiv(e),this.document.removeEventListener("click",n))}.bind(this))}},{key:"redirect",value:function(t){window.open(t,"_blank")}},{key:"applyIframeClickRedirect",value:function(t,e,n){var r=this;window.addEventListener("message",(function(i){"zeoFrameClick"===i[i.message?"message":"data"]&&(r.logInteractionClicked(t),r.redirect(n),r.removeDiv(e))}),!1)}},{key:"getStyleForPosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";switch(t){case"center":return{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"};case"bottom":return{position:"absolute",bottom:"0",left:"0"};case"absoluteLeft":return{position:"absolute",left:"0"};default:return{}}}},{key:"getStyleFromSizeDetails",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.width,n=t.height;return{width:e?"".concat(e,"px"):"fit-content",height:n?"".concat(n,"px"):"fit-content"}}},{key:"addImageWithAnchor",value:function(t,e,n){var r,i,o=n.imageUrl,a=n.anchorUrl,s=null!==(r=null==t||null===(i=t.configDetails)||void 0===i?void 0:i.openInNewPage)&&void 0!==r&&r,c=this.document.createElement("a");c.href=a,c.target=s?"_blank":"_self",c.addEventListener("click",(function(){this.logInteractionClicked(t),this.removeDiv(e)}));var u=this.document.createElement("img");u.style.width="100%",u.style.height="auto",u.style.objectFit="contain",u.style.display="block",u.src=o,c.appendChild(u),e.appendChild(c)}},{key:"appendIframeToDiv",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#",i=this.document.createElement("iframe");return i.src=n,i.style.width="100%",i.style.height="100%",i.style.border="unset",i.onload=function(){this.applyIframeClickRedirect(t,e,r)}.bind(this),e.appendChild(i),i}},{key:"displayOverlayInteraction",value:function(t){console.log("displayOverlayInteraction ",t);var e=this.getStyleForPosition("center"),n=(null==t?void 0:t.displayConfigDetails)||{},r=n.style||{},i=n.redirectUrl||"",o=n.tagType||"",a=n.src||"",s=me(me(me({},e),r),{},{borderRadius:"8px",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.2)",height:"auto","max-height":"90%","aspect-ratio":"16 / 9"}),c=this.createDiv({position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.7)"},"overlayDiv"),u=this.createDiv(s,"overlayContentDiv");this.addCloseButtonToDivTopRight(t,u),"img"===o?this.addImageWithAnchor(t,u,{imageUrl:a,anchorUrl:i}):this.appendIframeToDiv(t,u,a,i),c.appendChild(u),u.remove=function(){c.remove()},this.appendDivToBody(c)}},{key:"displayStickyBanner",value:function(t){console.log("displayStickyBanner ",t);var e=(null==t?void 0:t.displayConfigDetails)||{},n=this.getStyleForPosition("absoluteLeft"),r=e.style||{},i=e.redirectUrl||"",o=e.tagType||"",a=e.src||"",s=me(me(me({},n),r),{},{width:"100%",overflow:"hidden","box-shadow":"0 -2px 5px rgba(0, 0, 0, 0.1)"}),c=this.createDiv(s,"stickyBannerDiv");this.addCloseButtonToDivTopRight(t,c),"img"===o?this.addImageWithAnchor(t,c,{imageUrl:a,anchorUrl:i}):this.appendIframeToDiv(t,c,a,i),this.appendDivToBody(c)}},{key:"displayPopupInteraction",value:function(t){var e=(null==t?void 0:t.configDetails)||{},n=this.getStyleForPosition(e.position),r=e.sizeDetails||{},i=e.redirectUrl||"",o=e.tagType||"",a=e.src||"",s=e.tintBackgroundForPopup||!1,c=e.tintBackgroundColor||"rgba(0,0,0,0.5)",u=this.createDiv({position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:c,"z-index":"9999998"},"containerDiv");if(a){var l=this.createDiv(me(me(me({},{"z-index":"9999999"}),n),r));this.addCloseButtonToDivTopRight(t,l),"image"===o?this.addImageWithAnchor(t,l,{imageUrl:a,anchorUrl:i}):this.appendIframeToDiv(t,l,a,i),s?(u.appendChild(l),l.remove=function(){u.remove()},this.appendDivToBody(u)):this.appendDivToBody(l)}}},{key:"filterDisplayInteractions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.filter((function(t){return Yi.includes(t.displayConfigDetails.displayType)}))}},{key:"pickFirstDisplayInteractionOfEachType",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this.filterDisplayInteractions(t),n=e.reduce((function(t,e){var n=e.displayConfigDetails.displayType;return t[n]||(t[n]=e),t}),{});return Xi.map((function(t){return n[t]})).filter(Boolean)}},{key:"performDisplayInteraction",value:function(t){var e=((null==t?void 0:t.displayConfigDetails)||{}).displayType;switch(console.log("displayType ",t),e){case"sticky-banner":return this.displayStickyBanner(t),!0;case"fullscreen-overlay":return this.displayOverlayInteraction(t),!0;default:return!1}}}]),t}(),eo=function(){function t(e,n,r,i,o,a){_e(this,t),this.optionsService=e,this.logger=n,this.requestService=r,this.pageService=i,this.window=o,this.identityService=a,this.localStorage=o.localStorage,this.sessionStorage=o.sessionStorage,this.interactionLoggingService=new Vi(e,n,r),this.displayService=new to(o,this.interactionLoggingService)}var e,n,r;return Se(t,[{key:"fetchInteractions",value:(r=Hi(qi.mark((function t(){var e,n,r,i=this;return qi.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Qi(this.identityService.getAllIdentites()),n="".concat("https://interact-server-pmmxqjholq-ew.a.run.app/api","/interact/interactions"),t.next=5,new Zi((function(t,r){i.requestService.post(n,{body:me(me({},e),i.pageService.getPageProperties())},{basicAuthKey:btoa("w_k:"+i.optionsService.options.apiKey)},(function(e,n){if(e>=200&&e<300){var i=JSON.parse(n);t(i.interactions||[])}else r(new Error("Failed to fetch interactions"))}))}));case 5:return r=t.sent,t.abrupt("return",r);case 7:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"doEventInteraction",value:function(t){return this.window.dispatchEvent(new CustomEvent(t.eventName,{detail:t.data})),!0}},{key:"spliceValueFromData",value:function(t,e){var n=t[e];return delete t[e],n}},{key:"doFunctionInteraction",value:function(t){var e=me({},t.data);switch(t.functionName){case"setLocalStorage":var n=this.spliceValueFromData(e,"localStorageKey");return this.localStorage.setItem(n,be(e)),!0;case"setSessionStorage":var r=this.spliceValueFromData(e,"sessionStorageKey");return this.sessionStorage.setItem(r,be(e)),!0;case"setGlobalVariable":var i=this.spliceValueFromData(e,"globalVariableName");return this.window[i]=e,!0;case"globalCallback":var o=this.spliceValueFromData(e,"callbackName");return!!this.window[o]&&(this.window[o](e),!0);default:if(this.window[t.functionName])return this.window[t.functionName](e),!0}return!1}},{key:"doDataInteraction",value:function(t){var e=me({},t.data),n=(null==t?void 0:t.dataToSendConfigDetails)||{};if(!n.functionName)return!1;switch(n.functionName){case"setLocalStorage":var r=null==n?void 0:n.storageKey;return this.localStorage.setItem(r,be(e)),!0;case"setSessionStorage":var i=null==n?void 0:n.storageKey;return this.sessionStorage.setItem(i,be(e)),!0;case"setGlobalVariable":var o=null==n?void 0:n.variableName;return this.window[o]=e,!0;case"globalCallback":var a=null==n?void 0:n.callbackName;return!!this.window[a]&&(this.window[a](e),!0);default:if(this.window[t.functionName])return this.window[t.functionName](e),!0}return!1}},{key:"performDataInteractions",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!sn(e))return[];var n=e.filter((function(t){return"data"!==t.type})),r=e.filter((function(t){return"data"===t.type}));n.forEach((function(e){switch(e.type){case"event":t.callPixelOnDone(e)((function(){return t.doEventInteraction(e)}));break;case"function":t.callPixelOnDone(e)((function(){return t.doFunctionInteraction(e)}))}})),r.forEach((function(e){t.callPixelOnDone(e)((function(){return t.doDataInteraction(e)}))}))}},{key:"performDisplayInteractions",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!sn(e))return[];console.log("performDisplayInteractions",e);var n=this.displayService.pickFirstDisplayInteractionOfEachType(e);console.log("displayInteractions filtered and unique",n),n.forEach((function(e){t.callPixelOnDone(e)((function(){return t.displayService.performDisplayInteraction(e)}))}))}},{key:"performInteractions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!sn(t))return[];var e=t.filter((function(t){return"display"===t.type})),n=t.filter((function(t){return"display"!==t.type}));this.performDataInteractions(n),this.performDisplayInteractions(e)}},{key:"callPixelOnDone",value:function(t){var e=this;return function(n){n()&&e.interactionLoggingService.callInteractionPixel(t,"onPerform")}}},{key:"publishOnRecieve",value:(n=Hi(qi.mark((function t(){var e,n=this,r=arguments;return qi.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=r.length>0&&void 0!==r[0]?r[0]:[],sn(e)){t.next=3;break}return t.abrupt("return",[]);case 3:e.forEach((function(t){n.interactionLoggingService.callInteractionPixel(t,"onRecieve")}));case 4:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"resolveInteractions",value:(e=Hi(qi.mark((function t(){var e;return qi.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.fetchInteractions();case 3:return e=t.sent,t.next=6,this.publishOnRecieve(e);case 6:this.performInteractions(e),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return e.apply(this,arguments)})}]),t}(),no=function(){function t(e,n,r,i){var o=this;_e(this,t),this.optionsService=e,this.logger=n,this.interactionsService=r,this.identityService=i,this.optionsService.listenToOptionsChange((function(t){o.optionsService.options.apiKey&&(o.identityService.loadFromStorage(),o.identityService.stampAllUserIdentitiesInStorage(),o.identityService.events.reset(),o.listenToIdentityChange(),o.identityService.events.trigger(o.identityService.getAllIdentites()))}))}return Se(t,[{key:"listenToIdentityChange",value:function(){var t=this;this.identityService.events.listen((function(){t.onIdentityChange()}))}},{key:"onIdentityChange",value:function(){this.interactionsService.resolveInteractions()}},{key:"run",value:function(){this.resolveIdentifiers()}},{key:"resolveIdentifiers",value:function(){this.identityService.resolveAll()}},{key:"transformIdentitiesBasedOnConfiguration",value:function(t,e){return this.logger.logInfo("transformIdentitiesBasedOnConfiguration","Transforming identities based on Configuration: ",t),void 0===this.optionsService.options.areIdentitiesHashed?e?dr.validateHashedIdentities(t):dr.hashIdentities(dr.validateRawIdentities(t,!0)):!1===this.optionsService.options.areIdentitiesHashed?this.optionsService.options.hashIdentities?dr.hashIdentities(dr.validateRawIdentities(t,!0)):dr.validateRawIdentities(t):dr.validateHashedIdentities(t)}},{key:"setUserIdentities",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=this.identityService.getIdentity(),r=this.transformIdentitiesBasedOnConfiguration(me(me({},n),t),e);this.identityService.setIdentity(r),this.interactionsService.resolveInteractions()}},{key:"getUserIdentities",value:function(){return this.identityService.getIdentity()}}]),t}(),ro=function(){function t(e){var n=this,r=e.client,i=e.optionsService,o=e.logger,a=e.isRunningQ,s=void 0!==a&&a;_e(this,t),this._q=[],this._qcmp=[];var c=function(){return!!r},u=function(t,e){n._q.push([t].concat(e))};this.init=function(){var t;0!==arguments.length&&(t=1===arguments.length&&"object"===dr.getType(arguments.length<=0?void 0:arguments[0])?arguments.length<=0?void 0:arguments[0]:me({apiKey:arguments.length<=0?void 0:arguments[0]},arguments.length<=1?void 0:arguments[1]),i.setOptions(t),o.logInfo("InteractConnect initialized with options",t),this.runQueuedFunctions(),r.run())}.bind(this),this.runQueuedFunctions=function(){if(!s){s=!0;for(var t=0;t<this._q.length;t++){var e=this._q[t]||[],n=e&&e.length>0&&e[0]?this[e[0]]:function(){};if("function"==typeof n)n.apply(this,e.slice(1))}this._q=[],s=!1}}.bind(this),this.callMethod=function(){var t=arguments,e=t&&t.length>0&&t[0]?this[t[0]]:function(){};if("function"==typeof e){var n=e;n.apply(this,Array.prototype.slice.call(t,1))}}.bind(this),this.setUserIdentities=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];c()?r.setUserIdentities.apply(r,e):u("setUserIdentities",Array.prototype.slice.call(arguments,0))}.bind(this),this.getUserIdentities=function(){return r.getUserIdentities.apply(r,arguments)}}return Se(t,[{key:"init",value:function(t){}},{key:"setUserIdentities",value:function(t){}},{key:"getUserIdentities",value:function(){}},{key:"callMethod",value:function(){}}]),t}();function io(){return window.zeotap.getWriteKey()}function oo(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"zeotapInteract",r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=t[n]||{},o=e;if(o._q=i._q||[],o._q.length&&o._q[0].length){var a=o._q[0][0],s=o._q[0][1];if("init"===a){var c=o._q.shift();c[1]&&void 0!==c[1]?o.init(c[1]):o.init(io())}else if("callMethod"===a&&"init"===s){var u=o._q.shift();o.callMethod("init",u[2])}}k(t,n,{value:P(o),writable:r})}var ao=new gr(L);return function(t,e){var n=this;if(e.zeotap)return e.zeotap.scriptLoaded?void t(e):void e.addEventListener("zeotapLoaded",(function(r){t(e),e.removeEventListener("zeotapLoaded",n)}));t(e)}((function(t){var e=new On,n=new pr(e),r=new Ki,i=function(t,e,n,r){return t.zeotap?(r.logInfo("getIdentityService","Using zeotap collect sdk identity service"),{events:new Br,getIdentity:function(){},setIdentity:function(){},resolveAll:function(){},loadFromStorage:function(){},stampAllUserIdentitiesInStorage:function(){},getAllIdentites:t.zeotap.getAllIdentites}):new Kr(e,n,r)}(t,n,new yr(n,new Rr,Mr),ao),o=new eo(n,ao,new Ae,r,t,i),a=new no(n,ao,o,i);oo(t,new ro({client:a,optionsService:n,logger:ao}))}),window),oo}();
